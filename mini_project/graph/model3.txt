# model3
                             validation_split= 0.2
                            )

x_train = datagen.flow_from_directory( train_path,
                                target_size = (256, 256),
                                batch_size = 40,                # batch_size만큼 랜덤하게 변형된 이미지 획득
                                subset="training",
                                class_mode = 'categorical')

x_val = datagen.flow_from_directory( train_path,
                                target_size = (256, 256),  
                                batch_size = 40,              
                                subset="validation",
                                class_mode = 'categorical')

x_test = datagen.flow_from_directory( test_path,
                                target_size = (256, 256),
                                batch_size = 40,                
                                class_mode = 'categorical')

loss, acc =model.evaluate_generator(x_test, steps = 10, verbose = 2)


hist = model.fit_generator(x_train, epochs = 500, 
                           steps_per_epoch= 50,                       # 한 세대하다 몇번 생성기로부터 데이터를 얻을 것이가                 
                           validation_data= x_val,                   # validation_data 설정
                           validation_steps= 10,                    # [validation data수/배치사이즈]
                           callbacks= [es],
                           verbose = 2)
